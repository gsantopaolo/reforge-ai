phases:
  - id: select_module
    description: >
      Identify first bounded context (e.g., Order Processing) using DDD analysis.
    output: selected-module.json
    suggested_tools:
      - KnowledgeBaseTool
      - DomainModelAnalyzerTool

  - id: scaffold_modulith
    description: >
      Create Spring Modulith project; import module code,
      annotate with @Module, enable virtual threads.
    output: modulith-setup.zip
    suggested_tools:
      - CodeLoaderTool
      - ModulithGeneratorTool

  - id: apply_openrewrite
    description: >
      Run OpenRewrite Spring Boot 3.2 recipe to update build and APIs.
    output: rewrite-diffs.patch
    suggested_tools:
      - OpenRewriteTool

  - id: configure_gateway
    description: >
      Set up Spring Cloud Gateway routes for new module endpoints.
    output: gateway-config.yaml
    suggested_tools:
      - GatewayConfiguratorTool

  - id: compile_and_test
    description: >
      Compile on Java 21, run unit tests, and enable virtual threads.
    output: test-report.xml
    suggested_tools:
      - CompilerTool
      - TestRunnerTool

  - id: document_extraction
    description: >
      Update Mermaid diagrams and documentation to include new module and routing.
    output: updated-docs/
    suggested_tools:
      - DiagramGeneratorTool
      - DocumentationTool
